---
title: 'Bellabeat Case Study: Data Analysis'
author: "Andrew Greenwood"
date: "2023-10-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)
install.packages("ggplot2")
library(ggplot2)
install.packages("tidyverse")
library(tidyverse)
```

## Create the data frame
The data frame 'Daily_Activity_New' is modified from the original dataset in CSV format. The original dataset is available at https://zenodo.org/record/53894#.YMoUpnVKiP9
```{r echo=FALSE}
Daily_Activity <- read_csv("Dataset 1/dailyActivity_merged.csv")

Daily_Activity$ActivityDate <- mdy(Daily_Activity$ActivityDate)

Daily_Activity_Temp <- subset(Daily_Activity, select = -c(TrackerDistance, LoggedActivitiesDistance))

Daily_Activity_New <- Daily_Activity_Temp %>% 
  rename("FairlyActiveDistance"="ModeratelyActiveDistance", "LightlyActiveDistance"="LightActiveDistance", "SedentaryDistance"="SedentaryActiveDistance")
head(Daily_Activity_New)
```

## Explore the data
On average, what does this fitness tracker dataset look like? Here are the average and median steps, very active minutes, fairly active minutes, and lightly active minutes for an individual day in the sample.
```{r}
mean(Daily_Activity_New$TotalSteps)
median(Daily_Activity_New$TotalSteps)

mean(Daily_Activity_New$VeryActiveMinutes)
median(Daily_Activity_New$VeryActiveMinutes)

mean(Daily_Activity_New$FairlyActiveMinutes)
median(Daily_Activity_New$FairlyActiveMinutes)

mean(Daily_Activity_New$LightlyActiveMinutes)
median(Daily_Activity_New$LightlyActiveMinutes)
```

## Group the data
To understand the data better, we need to see each individual's data boiled down to a single row. This data frame shows the median daily steps, very active minutes, fairly active minutes, and lightly active minutes for each individual in the sample.
```{r echo=FALSE}
Daily_Activity_Summary <- Daily_Activity_New %>% 
  group_by(Id) %>% 
  summarise(Median_Steps = median(TotalSteps), Median_VeryActive = median(VeryActiveMinutes), Median_FairlyActive = median(FairlyActiveMinutes), Median_LightlyActive=median(LightlyActiveMinutes))
print(Daily_Activity_Summary)
```

## Plot the data
These 3 scatterplots show each of the 3 categories of activity on the x-axis vs. daily steps on the y-axis. Each point represents the typical day of an individual in the sample.


#### Median Very Active Minutes vs. Median Daily Steps
```{r}
ggplot(data=Daily_Activity_Summary) +
  geom_point(mapping=aes(x=Median_VeryActive, y=Median_Steps), color="red") +
  labs(y="Median Daily Steps", x="Median Very Active Minutes")
```


#### Median Fairly Active Minutes vs. Median Daily Steps
```{r}
ggplot(data=Daily_Activity_Summary) +
  geom_point(mapping=aes(x=Median_FairlyActive, y=Median_Steps), color="orange") +
  labs(y="Median Daily Steps", x="Median Fairly Active Minutes")
```


#### Median Lightly Active Minutes vs. Median Daily Steps
```{r}
ggplot(data=Daily_Activity_Summary) +
  geom_point(mapping=aes(x=Median_LightlyActive, y=Median_Steps), color="darkgreen") +
  labs(y="Median Daily Steps", x="Median Lightly Active Minutes")
```

## Conclusion
This data helps to refine the picture of our target audience. Based on this sample, most people who use fitness trackers maintain light activity throughout the day but do not exercise strenuously on a typical day. This is the person Bellabeat should have in mind as its target audience.